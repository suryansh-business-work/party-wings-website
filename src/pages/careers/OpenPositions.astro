---
const jobs = [
  {
    id: "PW-001",
    title: "Caller (Desk Job) - Position 1",
    location: "Desk Job",
    type: "Full Time",
    description:
      "Handle inbound/outbound calls for bookings and customer inquiries. Comfortable speaking politely, booking orders, and following scripts.",
    requirements: [
      "Good communication skills in English and local language",
      "Comfortable with phone calling and basic CRM tools",
      "Preferably female candidates",
    ],
  },
  {
    id: "PW-002",
    title: "Caller (Desk Job) - Position 2",
    location: "Desk Job",
    type: "Full Time",
    description:
      "Handle inbound/outbound calls for bookings and customer inquiries. Comfortable speaking politely, booking orders, and following scripts.",
    requirements: [
      "Good communication skills in English and local language",
      "Comfortable with phone calling and basic CRM tools",
      "Preferably female candidates",
    ],
  },
  {
    id: "PW-003",
    title: "Decoration Person",
    location: "Field Job",
    type: "Contract / On-site",
    description:
      "Responsible for event decoration setup and teardown at venues. Must be able to work flexible hours and handle physical work.",
    requirements: [
      "Experience with event decoration or stage setup",
      "Ability to lift and move decor items",
      "Comfortable working on-site and travelling to venues",
    ],
  },
  {
    id: "PW-004",
    title: "Chef",
    location: "Kitchen Job",
    type: "Full Time / On-site",
    description:
      "Prepare and manage event catering menus, ensure food quality and hygiene, and coordinate kitchen staff during events.",
    requirements: [
      "Proven experience as a cook or chef in catering or hotel industry",
      "Knowledge of large-scale food preparation and food safety standards",
      "Ability to work flexible hours including weekends",
    ],
  },
];
---

<section class="w-full bg-gradient-to-br from-blue-100 via-blue-50 to-teal-200 py-16 px-2">
  <div class="max-w-7xl mx-auto">
    <h2 class="text-3xl font-bold text-[#0071e3] mb-4 text-center">
      Open Positions
    </h2>
    <p class="text-lg text-gray-700 mb-10 text-center">
      Weâ€™re looking for passionate, talented people to help us build innovative
      solutions for businesses worldwide.
    </p>

    <!-- Search and Filters -->
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8">
      <input
        id="job-search"
        type="text"
        placeholder="Search jobs by title or description..."
        class="w-full md:w-1/3 px-4 py-2 rounded border border-gray-300 focus:ring-2 focus:ring-[#0071e3] outline-none transition"
      />
      <div class="flex gap-3 flex-wrap">
        <select id="job-type-filter" class="px-3 py-2 rounded border border-gray-300 focus:ring-2 focus:ring-[#0071e3] outline-none transition">
          <option value="">All Types</option>
          <option value="Full Time">Full Time</option>
          <option value="Part Time">Part Time</option>
        </select>
        <select id="job-location-filter" class="px-3 py-2 rounded border border-gray-300 focus:ring-2 focus:ring-[#0071e3] outline-none transition">
          <option value="">All Locations</option>
          <option value="Remote / India">Remote / India</option>
        </select>
      </div>
    </div>

    <div
      class="grid gap-8 mb-16 w-full px-2 md:px-8"
      id="job-list"
    >
      {
        jobs.map((job, idx) => (
          <div
            class="bg-white rounded-xl shadow p-6 opacity-0 translate-y-8 transition-all duration-500"
            style={`transition-delay: ${idx * 80}ms`}
            data-title={job.title.toLowerCase()}
            data-description={job.description.toLowerCase()}
            data-type={job.type}
            data-location={job.location}
          >
            {/* Job ID at the top */}
            <div class="mb-2">
              <span class="inline-block text-xs font-bold bg-blue-100 text-blue-700 px-3 py-1 rounded-full tracking-widest">
                {job.id}
              </span>
            </div>
            <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-2">
              <h2 class="text-2xl font-semibold text-[#0071e3]">{job.title}</h2>
              <span class="text-sm text-gray-500">
                {job.location} &middot; {job.type}
              </span>
            </div>
            <p class="text-gray-700 mb-2">{job.description}</p>
            {/* Skills as tags */}
            <div class="flex flex-wrap gap-2 mb-4">
              {job.requirements.map((req) => (
                <span class="inline-block bg-blue-50 text-blue-700 text-xs px-3 py-1 rounded-full">{req}</span>
              ))}
            </div>
            <a
              href="#apply-now-form"
              onclick="document.getElementById('apply-now-form')?.scrollIntoView({ behavior: 'smooth', block: 'start' }); return false;"
              class="inline-block bg-[#0071e3] text-white font-semibold px-6 py-2 rounded-[10px] shadow hover:bg-[#005bb5] transition"
            >
              Apply Now
            </a>
          </div>
        ))
      }
      <div id="no-jobs-message" class="hidden col-span-full text-center text-lg text-gray-500 py-12">
        No job available as per selected filter.
      </div>
    </div>
  </div>
</section>

<script is:inline>
  // Animate job cards on scroll into view
  document.addEventListener("DOMContentLoaded", function () {
    const cards = document.querySelectorAll("#job-list > div:not(#no-jobs-message)");
    const noJobsMsg = document.getElementById("no-jobs-message");
    const reveal = () => {
      cards.forEach((card) => {
        const rect = card.getBoundingClientRect();
        if (rect.top < window.innerHeight - 60) {
          card.classList.add("opacity-100", "translate-y-0");
        }
      });
    };
    reveal();
    window.addEventListener("scroll", reveal, { passive: true });
    document
      .getElementById("job-list")
      .addEventListener("scroll", reveal, { passive: true });

    // Search and filter logic
    const searchInput = document.getElementById("job-search");
    const typeFilter = document.getElementById("job-type-filter");
    const locationFilter = document.getElementById("job-location-filter");

    function filterJobs() {
      const search = searchInput.value.toLowerCase();
      const type = typeFilter.value;
      const location = locationFilter.value;
      let visibleCount = 0;
      cards.forEach(card => {
        const title = card.getAttribute("data-title");
        const desc = card.getAttribute("data-description");
        const cardType = card.getAttribute("data-type");
        const cardLocation = card.getAttribute("data-location");
        const matchesSearch = title.includes(search) || desc.includes(search);
        const matchesType = !type || cardType === type;
        const matchesLocation = !location || cardLocation === location;
        if (matchesSearch && matchesType && matchesLocation) {
          card.style.display = "";
          visibleCount++;
        } else {
          card.style.display = "none";
        }
      });
      if (noJobsMsg) {
        noJobsMsg.style.display = visibleCount === 0 ? "" : "none";
      }
    }

    searchInput.addEventListener("input", filterJobs);
    typeFilter.addEventListener("change", filterJobs);
    locationFilter.addEventListener("change", filterJobs);

    // Initial filter to handle empty state on load
    filterJobs();
  });
</script>
